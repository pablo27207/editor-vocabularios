{% extends 'base.html' %}

{% block content %}
<div class="mb-6">
    <h1 class="text-3xl font-bold text-slate-800 dark:text-white">
        <span class="lang-es">{{ _('Vocabularios') }}</span>
        <span class="lang-en">Vocabularies</span>
    </h1>
    <p class="text-gray-600 dark:text-gray-400 mt-1">
        <span class="lang-es">{{ _('Explora y gestiona los vocabularios controlados del sistema.') }}</span>
        <span class="lang-en">Explore and manage the system's controlled vocabularies.</span>
    </p>
</div>

<!-- Action Buttons -->
{% if user_role in ['admin', 'reviewer', 'editor'] %}
<div class="flex gap-3 mb-6">
    <a href="{{ url_for('vocab.vocab_create_form') }}"
        class="px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded transition-colors">
        + <span class="lang-es">{{ _('Crear vocabulario') }}</span>
        <span class="lang-en">Create Vocabulary</span>
    </a>
    <a href="{{ url_for('vocab.vocab_import_form') }}"
        class="px-5 py-2.5 border border-blue-600 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 font-medium rounded transition-colors">
        <span class="lang-es">{{ _('Importar desde archivo') }}</span>
        <span class="lang-en">Import from File</span>
    </a>
</div>
{% endif %}

<!-- Vocabularies Table -->
<div class="panel-container">
    <table class="min-w-full divide-y divide-gray-200 dark:divide-neutral-700">
        <thead class="bg-gray-50 dark:bg-neutral-900">
            <tr>
                <th class="table-header-cell">
                    <span class="lang-es">{{ _('Nombre') }}</span>
                    <span class="lang-en">Name</span>
                </th>
                <th class="table-header-cell">
                    <span class="lang-es">{{ _('Código') }}</span>
                    <span class="lang-en">Code</span>
                </th>
                <th class="table-header-cell text-center">
                    <span class="lang-es">{{ _('Conceptos') }}</span>
                    <span class="lang-en">Concepts</span>
                </th>
                <th class="table-header-cell">
                    <span class="lang-es">{{ _('Versión') }}</span>
                    <span class="lang-en">Version</span>
                </th>
                <th class="table-header-cell">
                    <span class="lang-es">{{ _('Última modificación') }}</span>
                    <span class="lang-en">Last Modified</span>
                </th>
            </tr>
        </thead>
        <tbody class="bg-white dark:bg-neutral-800 divide-y divide-gray-200 dark:divide-neutral-700">
            {% for vocab in vocabularies %}
            <tr class="hover:bg-slate-50 dark:hover:bg-neutral-700/50 transition-colors cursor-pointer"
                onclick="window.location='{{ url_for('vocab.view_vocab', vocab_id=vocab.id) }}'">
                <td class="table-cell">
                    <a href="{{ url_for('vocab.view_vocab', vocab_id=vocab.id) }}"
                        class="text-blue-600 dark:text-blue-400 hover:underline font-medium">
                        <span class="lang-es">{{ vocab.name }}</span>
                        <span class="lang-en">{{ vocab.name_en or vocab.name }}</span>
                    </a>
                    {% if vocab.description %}
                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 truncate max-w-md">
                        {{ vocab.description[:80] }}{% if vocab.description|length > 80 %}...{% endif %}
                    </p>
                    {% endif %}
                </td>
                <td class="table-cell text-gray-600 dark:text-gray-400 font-mono text-sm">
                    {{ vocab.code }}
                </td>
                <td class="table-cell text-center">
                    <span
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300">
                        {{ vocab_stats.get(vocab.id, 0) }}
                    </span>
                </td>
                <td class="table-cell text-gray-500 dark:text-gray-400">
                    {{ vocab.version or '-' }}
                </td>
                <td class="table-cell text-gray-500 dark:text-gray-400 text-sm">
                    {% if vocab_last_modified.get(vocab.id) %}
                    {{ vocab_last_modified[vocab.id].strftime('%d/%m/%Y') }}
                    {% else %}
                    -
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" class="px-6 py-8 text-center text-gray-500 dark:text-gray-400">
                    <p class="mb-2">
                        <span class="lang-es">{{ _('No hay vocabularios cargados.') }}</span>
                        <span class="lang-en">No vocabularies loaded.</span>
                    </p>
                    {% if user_role in ['admin', 'reviewer', 'editor'] %}
                    <a href="{{ url_for('vocab.vocab_create_form') }}"
                        class="text-blue-600 dark:text-blue-400 hover:underline">
                        <span class="lang-es">{{ _('Crear el primero') }}</span>
                        <span class="lang-en">Create the first one</span>
                    </a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}